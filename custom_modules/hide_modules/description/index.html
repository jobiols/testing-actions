<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.15.1: http://docutils.sourceforge.net/" />
<title>Custom CGE</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="custom-cge">
<h1 class="title">Custom CGE</h1>

<!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!! This file is generated by oca-gen-addon-readme !!
!! changes will be overwritten.                   !!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
<p><a class="reference external" href="https://odoo-community.org/page/development-status"><img alt="Beta" src="https://img.shields.io/badge/maturity-Beta-yellow.png" /></a> <a class="reference external" href="http://www.gnu.org/licenses/agpl-3.0-standalone.html"><img alt="License: AGPL-3" src="https://img.shields.io/badge/licence-AGPL--3-blue.png" /></a> <a class="reference external" href="https://github.com/quilsoft/cge/tree/13.0/custom_cge"><img alt="quilsoft/cge" src="https://img.shields.io/badge/github-quilsoft%2Fcge-lightgray.png?logo=github" /></a></p>
<p>Este módulo implementa la customización de la liquidación de sueldos para CGE con la
siguiente especificación.</p>
<p>Aclaramos que Concepto es lo mismo que Regla Salarial.</p>
<p>.</p>
<div class="section" id="multiplicidad-de-contratos">
<h1>Multiplicidad de contratos</h1>
<ol class="arabic simple">
<li>Se Elimina la restriccion de un solo contrato por empleado.</li>
<li>En la vista de nominas de empleados y dentro del form procesamiento de nóminas, se agrega la columna <strong>Contrato</strong></li>
<li>Si un empleado tiene mas de un contrato <strong>activo</strong> al generarlo a la nomina aparecerá una vez por cada contrato.</li>
</ol>
<p>.</p>
</div>
<div class="section" id="periodos">
<h1>Periodos</h1>
<p>Para permitir el procesamiento por periodos se agrega en la regla salarial su fecha de
vigencia, <strong>Vigencia desde</strong> / <strong>Vigencia hasta</strong></p>
<p>Al procesar la nómina NO se van a considerar las Reglas Salariales cuya vigencia esté
fuera del periodo liquidado.</p>
<p>La Regla Salarial tiene dos fechas, Inicio de Vigencia y Fin de Vigencia dándose tres
casos:</p>
<p><strong>Solo inicio de vigencia</strong>:  Es valida siempre que el Incio de vigencia sea anterior
o igual al inicio del periodo considerado.</p>
<p><strong>Solo fin de vigencia</strong>: Es válida siempre que el Fin de vigencia sea posteror o igual
al fin del periodo considerado:</p>
<p><strong>Ambas fechas</strong>: Interseccion de las anteriores.</p>
<p><strong>Reglas hijas</strong> En el caso de las reglas hijas, estas se consideran en forma independiente
de la regla padre es decir no importa si la regla padre queda incluida o no en la liquidación.
Todas las reglas hijas, nietas, etc. seran evaluadas e incluidas si las fechas lo permiten.</p>
<p>.</p>
</div>
<div class="section" id="regimen-salarial-para-el-calculo-de-conceptos">
<h1>Régimen Salarial para el calculo de conceptos</h1>
<p>Al Régimen Salarial se le agrega un campo Estructura Salarial
Se elimina el campo Estructura Salarial del Contrato.</p>
<p>Para encontrar las reglas salariales a liquidar desde un contrato:</p>
<ol class="arabic simple">
<li>Al liquidar un contrato se busca su Regimen Salarial</li>
<li>El Regimen Salarial apunta a una Estructura Salarial</li>
<li>La estructura Salarial tiene un conjunto de Reglas Salariales</li>
</ol>
<p>.</p>
</div>
<div class="section" id="base-de-calculos">
<h1>Base de cálculos</h1>
<p>Se agrega un modelo hr.calculation.base (base de cálculo) el cual permite agregar
parámetros en la formulación del cálculo de los conceptos.</p>
<p>De este modelo generico heredan otros tres que personalizan para cada uno de los modelos
hr.agent, hr.contract y tb_cargo_salarial</p>
<ul class="simple">
<li>hr.calculation.base.agent</li>
<li>hr.calculation.base.contract</li>
<li>hr.calculation.base.cargo_salarial</li>
</ul>
<p>Luego en las vistas de cada uno de estos objetos habrá una solapa donde agregar bases
de calculo. Las bases de calculo tienen los siguientes campos, por ejemplo:</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="9%" />
<col width="17%" />
<col width="17%" />
<col width="20%" />
<col width="8%" />
<col width="9%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Nombre</th>
<th class="head">Código</th>
<th class="head">Fecha desde</th>
<th class="head">Fecha hasta</th>
<th class="head">Liquidación</th>
<th class="head">Valor</th>
<th class="head">Activo</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>Descuento 33</td>
<td>R33</td>
<td>10/01/2021</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>-2.58</td>
<td>True</td>
</tr>
<tr><td>Unica vez</td>
<td>UV33</td>
<td>10/01/2021</td>
<td>31/02/2020</td>
<td>&nbsp;</td>
<td>12.58</td>
<td>True</td>
</tr>
<tr><td>Otra vez</td>
<td>UV34</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>548</td>
<td>15.00</td>
<td>True</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Si no tienen Fechas ni liquidación aplican a todos</li>
<li>Si tienen una o ambas fechas se usan para limitar la aplicación y no pueden tener liquidación</li>
<li>Si tienen liquidación aplican a esa liquidación y no pueden tener fechas</li>
</ul>
<p>Dentro del código python se podrá acceder a estos datos invocando la funcion</p>
<p><strong>&lt;objeto&gt;.bc(code, payslip[, value])</strong></p>
<p>precedida por el objeto al cual le queremos pedir la base de calculo.</p>
<p>Parametros:</p>
<ul class="simple">
<li><strong>code</strong>: El codigo de la base de cálculo, es un string entre comillas dobles</li>
<li><strong>payslip</strong>: Variable payslip definida en el contexto</li>
<li><strong>value</strong> (opcional): Valor a ser devuelto si no se encuentra o no es aplicable el código, por defecto False.</li>
</ul>
<p>Ejemplos:</p>
<p><strong>employee.bc(“R33”, payslip)</strong> devolverá el valor. o False si no existe el codigo en la base de
datos del empleado o no aplica por fecha o por liquidación.</p>
<p><strong>contract.bc(“R33”, payslip, 0)</strong> devolverá el valor requerido o cero.</p>
<p><strong>cargo_salarial.bc(“R33”, payslip)</strong> devolverá el valor o False según aplique o no</p>
<p>.</p>
</div>
<div class="section" id="tipos-de-liquidacion">
<h1>Tipos de Liquidación</h1>
<p>Agregamos una nueva tabla definida en Nomina &gt; Configuracion &gt; Tipos de Liquidación
la cual define los Tipos de Liquidación. Un tipo de liquidación es un conjunto de
Reglas Salariales.</p>
<p>Dentro de la regla Salarial se agrega un campo Tipo de Liquidacion que es requerido,
finalmente al crear un proceso de Nómina aparece también el Tipo de Liquidación como
campo requerido.</p>
<p>Cuando se procesa la nómina además de todos los filtros de reglas que hay:</p>
<ul class="simple">
<li>Las fechas de validez de las Reglas Salariales que verifican contra el periodo</li>
<li>El Régimen Salarial que se define en el Contrato y define una Estructura Salarial</li>
<li>La estructura Salarial que define un conjunto de Reglas Salariales</li>
</ul>
<p>Se agrega el Tipo de Liquidación como un ultimo filtro que deja pasar solamente
las reglas que tiene definidas.</p>
<p>Si en lugar de procesar nomina se ingresa a una nomina particular y se toca el boton
<strong>Calcular hoja</strong>, el Tipo de Liquidacion no estará definido por lo que hay que ingresarlo
manualmente en ese formulario antes de hacer Calcular Hoja.
Seguramente este comportamiento deberá ser revisado.</p>
<p>.</p>
</div>
<div class="section" id="referencia-a-conceptos-dentro-de-formulas-y-totales-informes">
<h1>Referencia a conceptos dentro de fórmulas y totales/informes</h1>
<p>En una Regla Salarial el codigo python puede hacer referencia a otra regla, o a una
categoria de reglas. Se debe tener en cuenta que las reglas invocadas hayan sido
calculadas previamente, para ordenar las reglas se tiene el campo secuencia en la
Regla Salarial.</p>
<p>El codigo por el que se invoca la Regla Salarial NO ES UNICO, para identificar cual es
el codigo correcto se filtra por</p>
<ul class="simple">
<li>Régimen Salarial, definido en el Servicio</li>
<li>Estructura Salarial, definida en el Régimen Salarial</li>
<li>Tipo de Liquidación,</li>
<li>Vigencia de la Regla Salarial definida en el periodo liquidado</li>
</ul>
<p><strong>Table of contents</strong></p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#bug-tracker" id="id1">Bug Tracker</a></li>
<li><a class="reference internal" href="#credits" id="id2">Credits</a><ul>
<li><a class="reference internal" href="#authors" id="id3">Authors</a></li>
<li><a class="reference internal" href="#contributors" id="id4">Contributors</a></li>
<li><a class="reference internal" href="#other-credits" id="id5">Other credits</a></li>
<li><a class="reference internal" href="#maintainers" id="id6">Maintainers</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="bug-tracker">
<h2><a class="toc-backref" href="#id1">Bug Tracker</a></h2>
<p>Bugs are tracked on <a class="reference external" href="https://github.com/quilsoft/cge/issues">GitHub Issues</a>.
In case of trouble, please check there if your issue has already been reported.
If you spotted it first, help us smashing it by providing a detailed and welcomed
<a class="reference external" href="https://github.com/quilsoft/cge/issues/new?body=module:%20custom_cge%0Aversion:%2013.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**">feedback</a>.</p>
<p>Do not contact contributors directly about support or help with technical issues.</p>
</div>
<div class="section" id="credits">
<h2><a class="toc-backref" href="#id2">Credits</a></h2>
<div class="section" id="authors">
<h3><a class="toc-backref" href="#id3">Authors</a></h3>
<ul class="simple">
<li>Quilsoft</li>
</ul>
</div>
<div class="section" id="contributors">
<h3><a class="toc-backref" href="#id4">Contributors</a></h3>
<ul class="simple">
<li>Jorge Obiols &lt;<a class="reference external" href="mailto:jorge.obiols&#64;gmail.com">jorge.obiols&#64;gmail.com</a>&gt; (www.jeosoft.com.ar)</li>
</ul>
</div>
<div class="section" id="other-credits">
<h3><a class="toc-backref" href="#id5">Other credits</a></h3>
<p>Quilsoft</p>
</div>
<div class="section" id="maintainers">
<h3><a class="toc-backref" href="#id6">Maintainers</a></h3>
<p>This module is part of the <a class="reference external" href="https://github.com/quilsoft/cge/tree/13.0/custom_cge">quilsoft/cge</a> project on GitHub.</p>
<p>You are welcome to contribute.</p>
</div>
</div>
</div>
</div>
</body>
</html>
